import VitePlugin from '@unocss/vite';

function UnoCSSAstroIntegration(options = {}, defaults) {
  const {
    injectEntry = true,
    injectReset: includeReset = true,
    injectExtra = []
  } = options;
  return {
    name: "unocss",
    hooks: {
      "astro:config:setup": async ({ config, injectScript }) => {
        var _a;
        (_a = config.vite).plugins || (_a.plugins = []);
        config.vite.plugins.push(...VitePlugin(options, defaults));
        const injects = [];
        if (includeReset) {
          const resetPath = typeof includeReset === "string" ? includeReset : "@unocss/reset/tailwind.css";
          injects.push(`import "${resetPath}"`);
        }
        if (injectEntry) {
          injects.push(typeof injectEntry === "string" ? injectEntry : 'import "uno.css"');
        }
        if (injectExtra.length > 0)
          injects.push(...injectExtra);
        if (injects?.length)
          injectScript("page-ssr", injects.join("\n"));
      }
    }
  };
}

export { UnoCSSAstroIntegration as default };
