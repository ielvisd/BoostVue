"use strict";var BN=require("bn.js"),$=require("../util/preconditions"),_=require("../util/_"),reversebuf=function(r){for(var e=Buffer.alloc(r.length),t=0;t<r.length;t++)e[t]=r[r.length-1-t];return e};BN.Zero=new BN(0),BN.One=new BN(1),BN.Minus1=new BN(-1),BN.fromNumber=function(r){return $.checkArgument(_.isNumber(r)),new BN(r)},BN.fromString=function(r,e){return $.checkArgument(_.isString(r)),new BN(r,e)},BN.fromBuffer=function(r,e){void 0!==e&&"little"===e.endian&&(r=reversebuf(r));var t=r.toString("hex");return new BN(t,16)},BN.fromSM=function(r,e){var t;if(0===r.length)return BN.fromBuffer(Buffer.from([0]));var n="big";return e&&(n=e.endian),"little"===n&&(r=reversebuf(r)),128&r[0]?(r[0]=127&r[0],(t=BN.fromBuffer(r)).neg().copy(t)):t=BN.fromBuffer(r),t},BN.prototype.toNumber=function(){return parseInt(this.toString(10),10)},BN.prototype.toBuffer=function(r){var e,t;if(r&&r.size){var n=(t=this.toString(16,2)).length/2;e=Buffer.from(t,"hex"),n===r.size||(n>r.size?e=BN.trim(e,n):n<r.size&&(e=BN.pad(e,n,r.size)))}else t=this.toString(16,2),e=Buffer.from(t,"hex");return void 0!==r&&"little"===r.endian&&(e=reversebuf(e)),e},BN.prototype.toSMBigEndian=function(){var r;return-1===this.cmp(BN.Zero)?128&(r=this.neg().toBuffer())[0]?r=Buffer.concat([Buffer.from([128]),r]):r[0]=128|r[0]:128&(r=this.toBuffer())[0]&&(r=Buffer.concat([Buffer.from([0]),r])),1===r.length&0===r[0]&&(r=Buffer.from([])),r},BN.prototype.toSM=function(r){var e=r?r.endian:"big",t=this.toSMBigEndian();return"little"===e&&(t=reversebuf(t)),t},BN.fromScriptNumBuffer=function(r,e,t){var n=t||4;if($.checkArgument(r.length<=n,new Error("script number overflow")),e&&r.length>0&&0==(127&r[r.length-1])&&(r.length<=1||0==(128&r[r.length-2])))throw new Error("non-minimally encoded script number");return BN.fromSM(r,{endian:"little"})},BN.prototype.toScriptNumBuffer=function(){return this.toSM({endian:"little"})},BN.trim=function(r,e){return r.slice(e-r.length,r.length)},BN.pad=function(r,e,t){for(var n=Buffer.alloc(t),f=0;f<r.length;f++)n[n.length-1-f]=r[r.length-1-f];for(f=0;f<t-e;f++)n[f]=0;return n},BN.prototype.toHex=function(...r){return this.toBuffer(...r).toString("hex")},BN.fromHex=function(r,...e){return BN.fromBuffer(Buffer.from(r,"hex"),...e)},module.exports=BN;